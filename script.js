// Объект со всеми переводами - ДОБАВЛЕН УКРАИНСКИЙ
const translations = {
    ru: {
        page_title_main: "Портфолио",
        hero_main_title: "TATTOOKIRILL YUVELIR",
        nav_about: "Обо мне",
        nav_services: "Услуги",
        nav_portfolio: "Работы",
        nav_process: "Процесс",
        nav_contact: "Контакты",
        hero_subtitle: "Tattoo Germany",
        hero_description_short: "Ваш мастер эксклюзивных татуировок", // Новый короткий текст
        hero_description: "Ваш мастер эксклюзивных татуировок.", // Обновлено
        hero_contact_btn: "Связаться",
        about_title: "Обо мне",
        about_description_new: "Привет! Меня зовут Кирилл, я тату-мастер, и свой путь в этой профессии начал довольно рано — в 16 лет. Всё началось с моей первой татуировки, которую я сделал без разрешения родителей. Этот опыт перевернул моё восприятие: я понял, что татуировка — это не просто рисунок на теле, а настоящее искусство и способ самовыражения.",
        about_description_new_part2: "После этого я решил пойти на обучение и погрузился в мир татуировок всерьёз. С тех пор моя жизнь неразрывно связана с этой профессией. Я постоянно развиваюсь, пробую новые стили и техники, чтобы каждое моё тату было не просто работой, а уникальной историей, оставленной на теле человека.",
        services_title: "Услуги",
        services_realism_title: "Реализм",
        services_realism_description: "Детализация и глубина для потрясающих портретов и сюжетов.",
        services_japanese_title: "Японский стиль",
        services_japanese_description: "Традиционные мотивы и яркие образы с глубоким смыслом.",
        services_chikano_title: "Чикано",
        services_chikano_description: "Эстетика улиц и культурные символы, выполненные в характерном стиле.",
        services_graphic_title: "Графика",
        services_graphic_description: "Четкие линии и контраст для уникального графического искусства.",
        services_mini_title: "Мини-тату",
        services_mini_description: "Изящные и аккуратные татуировки, идеальные для первого раза.",
        portfolio_title: "Работы",
        process_title: "Процесс создания тату",
        process_step1_title: "Консультация и разработка",
        process_step1_description: "Обсуждение идеи, выбор стиля, разработка индивидуального эскиза. Отвечаю на все вопросы и помогаю определиться с деталями.",
        process_step2_title: "Подготовка",
        process_step2_description: "Подготовка кожи и рабочего места, стерилизация оборудования. Использую только одноразовые и сертифицированные материалы.",
        process_step3_title: "Нанесение тату",
        process_step3_description: "Аккуратное и профессиональное нанесение татуировки, с учетом всех нюансов и пожеланий клиента.",
        process_step4_title: "Завершение и рекомендации",
        process_step4_description: "Нанесение защитной повязки, подробные инструкции по уходу за свежей татуировкой для быстрого заживления и сохранения качества.",
        process_step5_title: "Коррекция и доработка",
        process_step5_description: "При необходимости провожу коррекцию татуировки после заживления, чтобы добиться идеального результата. Гарантирую, что вы будете довольны своей новой татуировкой.",
        contact_title: "Контакты",
        contact_info_text: "Готов ответить на все ваши вопросы и записать на консультацию. Свяжитесь со мной удобным для вас способом!",
        contact_name_label: "Ваше имя:",
        contact_email_label: "Ваш Email:",
        contact_message_label: "Ваше сообщение:",
        contact_send_btn: "Отправить",
        footer_rights: "Все права защищены."
    },
    uk: {
        page_title_main: "Портфоліо",
        hero_main_title: "TATTOOKIRILL YUVELIR",
        nav_about: "Про мене",
        nav_services: "Послуги",
        nav_portfolio: "Роботи",
        nav_process: "Процес",
        nav_contact: "Контакти",
        hero_subtitle: "Tattoo Germany",
        hero_description_short: "Ваш майстер ексклюзивних татуювань",
        hero_description: "Ваш майстер ексклюзивних татуювань.",
        hero_contact_btn: "Зв'язатися",
        about_title: "Про мене",
        about_description_new: "Привіт! Мене звуть Кирило, я тату-майстер, і свій шлях у цій професії розпочав досить рано — у 16 років. Все почалося з мого першого татуювання, яке я зробив без дозволу батьків. Цей досвід перевернув моє сприйняття: я зрозумів, що татуювання — це не просто малюнок на тілі, а справжнє мистецтво та спосіб самовираження.",
        about_description_new_part2: "Після цього я вирішив піти на навчання та занурився у світ татуювань всерйоз. З того часу моє життя нерозривно пов'язане з цією професією. Я постійно розвиваюся, пробую нові стилі та техніки, щоб кожне моє тату було не просто роботою, а унікальною історією, залишеною на тілі людини.",
        services_title: "Послуги",
        services_realism_title: "Реалізм",
        services_realism_description: "Деталізація та глибина для приголомшливих портретів та сюжетів.",
        services_japanese_title: "Японський стиль",
        services_japanese_description: "Традиційні мотиви та яскраві образи з глибоким сенсом.",
        services_chikano_title: "Чікано",
        services_chikano_description: "Естетика вулиць та культурні символи, виконані у характерному стилі.",
        services_graphic_title: "Графіка",
        services_graphic_description: "Чіткі лінії та контраст для унікального графічного мистецтва.",
        services_mini_title: "Міні-тату",
        services_mini_description: "Витончені та акуратні татуювання, ідеальні для першого разу.",
        portfolio_title: "Роботи",
        process_title: "Процес створення тату",
        process_step1_title: "Консультація та розробка",
        process_step1_description: "Обговорення ідеї, вибір стилю, розробка індивідуального ескізу. Відповідаю на всі питання та допомагаю визначитись з деталями.",
        process_step2_title: "Підготовка",
        process_step2_description: "Підготовка шкіри та робочого місця, стерилізація обладнання. Використовую лише одноразові та сертифіковані матеріали.",
        process_step3_title: "Нанесення тату",
        process_step3_description: "Акуратне та професійне нанесення татуювання, з урахуванням усіх нюансів та побажань клієнта.",
        process_step4_title: "Завершення та рекомендації",
        process_step4_description: "Нанесення захисної пов'язки, докладні інструкції по догляду за свіжою татуюванням для швидкого заживлення та збереження якості.",
        process_step5_title: "Корекція та доопрацювання",
        process_step5_description: "За необхідності проводжу корекцію татуювання після загоєння, щоб досягти ідеального результату. Гарантую, що ви будете задоволені своїм новим татуюванням.",
        contact_title: "Контакти",
        contact_info_text: "Готовий відповісти на всі ваші запитання та записати на консультацію. Зв'яжіться зі мною зручним для вас способом!",
        contact_name_label: "Ваше ім'я:",
        contact_email_label: "Ваш Email:",
        contact_message_label: "Ваше повідомлення:",
        contact_send_btn: "Надіслати",
        footer_rights: "Всі права захищені."
    }
};


document.addEventListener('DOMContentLoaded', () => {
    // Language switcher functionality
    const langSwitcher = document.getElementById('lang-switcher');
    const savedLang = localStorage.getItem('lang') || 'ru'; // Default to Russian if no language is saved
    langSwitcher.value = savedLang;
    applyTranslations(savedLang);

    langSwitcher.addEventListener('change', (event) => {
        const selectedLang = event.target.value;
        localStorage.setItem('lang', selectedLang);
        applyTranslations(selectedLang);
    });

    function applyTranslations(lang) {
        document.querySelectorAll('[data-lang-key]').forEach(element => {
            const key = element.dataset.langKey;
            if (translations[lang] && translations[lang][key]) {
                element.textContent = translations[lang][key];
            }
        });
        // Update meta description and keywords for SEO
        if (translations[lang]) {
            const metaDescription = document.querySelector('meta[name="description"]');
            if (metaDescription) {
                if (lang === 'ru') {
                    metaDescription.setAttribute('content', "Портфолио Кирилла Ювелира - мастера эксклюзивных татуировок в Германии: реализм, японский стиль, чикано, орнаментал, мини-тату.");
                } else if (lang === 'uk') {
                    metaDescription.setAttribute('content', "Портфоліо Кирила Ювеліра - майстра ексклюзивних татуювань в Німеччині: реалізм, японський стиль, чікано, орнаментал, міні-тату.");
                }
            }
            const metaKeywords = document.querySelector('meta[name="keywords"]');
            if (metaKeywords) {
                if (lang === 'ru') {
                    metaKeywords.setAttribute('content', "тату, татуировка, тату мастер, Германия, Хемниц, реализм, японский стиль, чикано, орнаментал, мини-тату, Kirill Yuvelir");
                } else if (lang === 'uk') {
                    metaKeywords.setAttribute('content', "тату, татуювання, тату майстер, Німеччина, Хемніц, реалізм, японський стиль, чікано, орнаментал, міні-тату, Kirill Yuvelir");
                }
            }
        }
    }


    // AOS initialization
    AOS.init({
        duration: 1000,
        once: true,
    });

    // Smooth scrolling for navigation links
    document.querySelectorAll('nav ul li a').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop,
                    behavior: 'smooth'
                });
            }
        });
    });

    // Scroll buttons and social media buttons visibility
    const scrollToTopBtn = document.getElementById('scrollToTopBtn');
    const scrollToBottomBtn = document.getElementById('scrollToBottomBtn');
    const socialFixedButtons = document.querySelector('.social-fixed-buttons'); // Новый селектор
    const scrollFixedButtons = document.querySelector('.scroll-fixed-buttons'); // Новый селектор

    function updateScrollButtonsVisibility() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const viewportHeight = window.innerHeight;

        // Show/hide scroll to top button
        if (scrollToTopBtn) {
            if (scrollTop > 200) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        }

        // Show/hide scroll to bottom button
        if (scrollToBottomBtn) {
            // Check if user is near the bottom of the page
            if (scrollTop + viewportHeight < documentHeight - 100) {
                scrollToBottomBtn.classList.add('visible');
            } else {
                scrollToBottomBtn.classList.remove('visible');
            }
        }

        // Show/hide social fixed buttons (left side)
        if (socialFixedButtons) {
            if (scrollTop > 100) { // Show when scrolled down a bit
                socialFixedButtons.classList.add('visible');
            } else {
                socialFixedButtons.classList.remove('visible');
            }
        }

        // Show/hide scroll fixed buttons (right side)
        if (scrollFixedButtons) {
            if (scrollTop > 100) { // Show when scrolled down a bit
                scrollFixedButtons.classList.add('visible');
            } else {
                scrollFixedButtons.classList.remove('visible');
            }
        }
    }

    window.addEventListener('scroll', updateScrollButtonsVisibility);

    if (scrollToTopBtn) {
        scrollToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }

    if (scrollToBottomBtn) {
        scrollToBottomBtn.addEventListener('click', () => {
            window.scrollTo({
                top: document.documentElement.scrollHeight,
                behavior: 'smooth'
            });
        });
    }

    // Initial check for button visibility on load
    updateScrollButtonsVisibility();
});

// Hide preloader once content is loaded
window.addEventListener('load', () => {
    const preloader = document.getElementById('preloader');
    if (preloader) {
        preloader.classList.add('hidden');
        preloader.addEventListener('transitionend', () => {
            preloader.style.display = 'none'; // Completely remove after transition
        });
    }
    // Initialize Glide.js carousels here once content is loaded
    
    // Services Carousel
    if (document.querySelector('.glide.services-carousel')) {
        new Glide('.glide.services-carousel', {
            type: 'carousel', // 'carousel' type for infinite loop
            startAt: 0,
            perView: 3,
            gap: 30,
            focusAt: 'center', // Focus on the center slide
            breakpoints: {
                992: {
                    perView: 2,
                    gap: 20
                },
                768: {
                    perView: 1,
                    gap: 10
                }
            }
        }).mount();
    }

    // Portfolio Carousel
    if (document.querySelector('.glide.portfolio-carousel')) {
        new Glide('.glide.portfolio-carousel', {
            type: 'carousel', // 'carousel' type for infinite loop
            startAt: 0,
            perView: 3,
            gap: 30,
            focusAt: 'center', // Focus on the center slide
            breakpoints: {
                992: {
                    perView: 2,
                    gap: 20
                },
                768: {
                    perView: 1,
                    gap: 10
                }
            }
        }).mount();
    }

    // Process Carousel
    if (document.querySelector('.glide.process-carousel')) {
        new Glide('.glide.process-carousel', {
            type: 'carousel', // 'carousel' type for infinite loop
            startAt: 0,
            perView: 3,
            gap: 30,
            focusAt: 'center', // Focus on the center slide
            breakpoints: {
                992: {
                    perView: 2,
                    gap: 20
                },
                768: {
                    perView: 1,
                    gap: 10
                }
            }
        }).mount();
    }
});


// Lightbox functionality
const lightbox = document.getElementById('lightbox');
const lightboxImg = document.getElementById('lightbox-img');
const closeBtn = document.querySelector('.lightbox-close');
const prevBtn = document.querySelector('.lightbox-prev');
const nextBtn = document.querySelector('.lightbox-next');
let currentImageIndex;
let galleryImages = [];

document.addEventListener('DOMContentLoaded', () => {
    const galleryItems = document.querySelectorAll('.portfolio-carousel .gallery-item img');
    galleryImages = Array.from(galleryItems);

    galleryItems.forEach((img, index) => {
        img.addEventListener('click', () => {
            currentImageIndex = index;
            showImage(currentImageIndex);
        });
    });

    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
            closeLightbox();
        }
    });

    prevBtn.addEventListener('click', showPrevImage);
    nextBtn.addEventListener('click', showNextImage);

    document.addEventListener('keydown', (e) => {
        if (lightbox.classList.contains('active')) {
            if (e.key === 'ArrowLeft') {
                showPrevImage();
            } else if (e.key === 'ArrowRight') {
                showNextImage();
            } else if (e.key === 'Escape') {
                closeLightbox();
            }
        }
    });
});

function showImage(index) {
    if (galleryImages.length > 0) {
        lightboxImg.src = galleryImages[index].src;
        lightbox.classList.add('active');
    }
}

function closeLightbox() {
    lightbox.classList.remove('active');
    lightboxImg.src = ''; // Clear the image source
}

function showPrevImage() {
    currentImageIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
    showImage(currentImageIndex);
}

function showNextImage() {
    currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
    showImage(currentImageIndex);
}